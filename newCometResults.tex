%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Tracing Overhead
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Tracing overhead}
\label{subsec:lowtoh}

\input{tabs.comet.newMed/comet_sd_pMpAcg_BC_itn_p3.5.tex}

Table \ref{comet_sd_pMpAcg_BC_itn_p3.5} shows the tracing overhead of \parlotm, \parlota, and \callgrind on each application of the NPB benchmark suite for different node counts. The last column of the table lists the geometric mean over all eight programs. The AVG rows show the average over the four node counts.

On average, both \parlotm and \parlota outperform \callgrind. The bolded numbers in Table \ref{comet_sd_pMpAcg_BC_itn_p3.5} for input C show that the average overhead is 1.94 for \parlotm, 2.73 for \parlota, and 4.63 for \callgrind. Figures \ref{comet_chartAvg_sd_B_p3_5} and \ref{comet_chartAvg_sd_C_p3_5} show these results in visual form.

Perhaps the key takeaway point is that the overhead of \parlot is roughly a factor of two to three, which we believe users are willing to accept if it helps them debug their applications. This is very promising especially when considering how detailed the collected trace information is. Similarly, it is reassuring to see that \parlot 's overhead is typically lower than that of \callgrind, which collects less information.

The overhead of \parlot increases as we scale the applications to more compute nodes. However, the increase is quite small. Going from 16 to 1024 cores, a 64-fold increase in parallelism, only increases the average overhead by between 1.3- and 2.1-fold. In contrast, \callgrind 's overhead decreases with increasing node count, making it more scalable. Having said that, \callgrind 's overhead is larger for the C inputs whereas \parlot 's overhead is larger for the smaller B inputs. In other words, \parlot scales better to larger inputs than \callgrind.

The reason for \parlot 's scaling behavior can be explained by correlating it with the expected function-call frequency. When distributing a fixed problem size over more cores, each core receives less work. As a consequence, less time is spent in the functions that process the work, resulting in more function calls per time unit, which causes more work for \parlot. In contrast, when distributing a larger problem size over the same number of cores, each core receives more work. Hence, more time is spent in the functions that process the work, resulting in fewer function calls per time unit, which causes less work for \parlot and therefore less tracing overhead. Hence, we believe \parlot 's overhead to be even lower on long-running inputs, which is where our tracing technique for debugging is needed the most.

In summary, \parlot 's overhead is in the single digits for all evaluated applications and configurations, including for 1024-core runs. It appears to scale reasonably to larger node counts and well to larger problem sizes.


\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartAvg_sd_B_p3_5.png}
\caption{ Input: B - Tracing Overhead
}
\label{comet_chartAvg_sd_B_p3_5}
\end{figure}


\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartAvg_sd_C_p3_5.png}
\caption{ Input: C - Tracing Overhead}
\label{comet_chartAvg_sd_C_p3_5}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Banwidth
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


  
\subsection{Required Bandwidth}
\label{subsec:lowbw}

\input{tabs.comet.newMed/comet_bw_pMpAcg_BC_itn_p3.5.tex}

Table \ref{comet_bw_pMpAcg_BC_itn_p3.5} shows how much bandwidth each tool occupied during the application execution. In addition to the large gap between average overhead of \parlotm and \callgrind, former also performs better than latter in required bandwidth, especially for smaller inputs. Since \parlota collects the trace of library function calls, there is no wonder why its required bandwidth is higher than other tools.

We observe from table \ref{comet_cr_pMpA_BC_itn_p3.5}, input C, the average compression ratio for \parlota is 644.38, and its corresponding required bandwidth from table \ref{comet_bw_pMpAcg_BC_itn_p3.5} is 56.38, which means \parlot can collect \textbf{more than 36 MB} worth of data per core per second where it only needs 56.38 kB/s bandwidth and leave the rest of available system bandwidth for application, while \callgrind can only collects \textbf{less than 100 kB} of traces and still adds more overhead comparing to either \parlota or \parlotm (fig. \ref{comet_chartAvg_bw_B_p3_5},\ref{comet_chartAvg_bw_C_p3_5}). The average amount of traces that can be collected by \parlota is \textbf{360x} (85x for \parlotm) larger than \callgrind and the average overhead \parlota adds is less than 0.6x (0.4x for \parlotm) smaller than \callgrind.

\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartAvg_bw_B_p3_5.png}
\caption{ Input: \textbf{B} - Required Bandwidth per core (kB/s)
}
\label{comet_chartAvg_bw_B_p3_5}
\end{figure}



\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartAvg_bw_C_p3_5.png}
\caption{ Input: \textbf{C}  - Required Bandwidth per core (kB/s)
}
\label{comet_chartAvg_bw_C_p3_5}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
\subsection{Compression Ratio}
\label{subsec:cr}

Table \ref{comet_cr_pMpA_BC_itn_p3.5} shows the compression ratios for all configurations and inputs. On average, \parlot can store up to more than 1700 MB of collected data in just 1 MB trace files. Compression mechanism of \parlot achieved more than 21k compression ratio (table \ref{comet_cr_pMpA_BC_itn_p3.5}, the entry for \parlotm, Input B, 1 node) and it has been achieved with adding low overhead and incrementally on the fly.
Generally, compression ratios for \parlotm are higher than \parlota. Since \parlota is collecting library function calls in addition to main image functions, chances of redundant data to compress decreases and causes drop in compression ratios.
  
\input{tabs.comet.newMed/comet_cr_pMpA_BC_itn_p3.5.tex}


\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartAvg_cr_C_p3_5.png}
\caption{ Input: \textbf{C}  - Compression Ratio
}
\label{comet_chartAvg_cr_C_p3_5}
\end{figure}


\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartAvg_cr_B_p3_5.png}
\caption{ Input: \textbf{B}  - Compression Ratio
}
\label{comet_chartAvg_cr_B_p3_5}
\end{figure}
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
  
\subsection{ \pininit Overhead} 
\label{subsec:pinit}
Tables \ref{comet_wo_det_Main_all_B_p3.5} and \ref{comet_wo_det_All_all_B_p3.5} show average overhead added to each application by different variations of \parlot. Last row of tables show geometric mean of each of its above values showing how much each phase of \parlot slows down the native execution. In general, we all expect that the added overhead of  \pininit < \parlot < \parlotnc. Highlighted cells in tables are the ones which do not follow the above order. The variability of 3 runs of each experiment is observable from boxes in figure \ref{comet_BX2_Main_16_B_p3_5} where it shows the minimum, maximum and median of overhead calculated overhead of each experiment for each tool, for input size B, 16 nodes.
This variability (which is similar for other inputs and nodes) justifies the inconsistent (highlighted) values in the table \ref{comet_wo_det_Main_all_B_p3.5} and \ref{comet_wo_det_All_all_B_p3.5}.


Tables \ref{comet_wo_det_Main_all_B_p3.5} and \ref{comet_wo_det_All_all_B_p3.5} shows that on average, \pininit adds 3.28 overhead and \parlota adds 3.42 overhead. \textbf{almost 96\% of \parlota overhead is added by \pininit} . Numbers from \parlotm and other inputs are following the same pattern (fig. \ref{comet_chartDet_B_wc_byTool_p3_5},\ref{comet_chartDet_C_wc_byTool_p3_5}).
The overhead that \parlot design (regardless of overhead of \pininit) adds to applications is extremely small and if we switch to a different instrumentation tool that is not as general as \pin but more lightweight, should help a great deal. \\

\input{tabs.comet.newMed/comet_wo_det_Main_all_B_p3.5.tex}

\input{tabs.comet.newMed/comet_wo_det_All_all_B_p3.5.tex}

\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartDet_B_wc_byTool_p3_5.png}
\caption{ Input: \textbf{B} - Tracing overhead added to the native run by each tool}
\label{comet_chartDet_B_wc_byTool_p3_5}
\end{figure}


\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartDet_C_wc_byTool_p3_5.png}
\caption{ Input: \textbf{C} - Tracing overhead added to the native run by each tool
}
\label{comet_chartDet_C_wc_byTool_p3_5}
\end{figure}






\subsection{Compression impact} 
\label{subsec:compact}

Fig. \ref{comet_chartDet_B_woc_byTool_p3_5} and Fig. \ref{comet_chartDet_C_woc_byTool_p3_5} show the impact and necassity of compression. On average, \parlotnc slows down the application execution almost \textbf{2x} more than \parlota. Average overhead of geometric means of all overheads within table \ref{comet_wo_det_All_all_B_p3.5} for \parlota is \textbf{3.42} and for its corresponding \parlotnc is \textbf{6.62}. The numbers of \parlotm and input C is following the same pattern. For example, \parlot-nc slows down the application execution almost \textbf{1.66x} more than \parlotm.


\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartDet_B_woc_byTool_p3_5.png}
\caption{ Input: B, Tracing overhead added by \pininit and \parlotnc
}
\label{comet_chartDet_B_woc_byTool_p3_5}
\end{figure}

\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_chartDet_C_woc_byTool_p3_5.png}
\caption{ Input: C, Tracing overhead added by \pininit and \parlotnc}
\label{comet_chartDet_C_woc_byTool_p3_5}
\end{figure}




\begin{figure}[!t]
\centering
\includegraphics[width=3.2in]{figs.comet.newMed/comet_BX2_Main_16_B_p3_5.png}
\caption{ Variability of \parlotm overhead on 16 nodes (Input B)
}
\label{comet_BX2_Main_16_B_p3_5}
\end{figure}

