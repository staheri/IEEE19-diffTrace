%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Tracing Overhead
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Tracing overhead}
\label{subsec:lowtoh}

\input{tabs.comet.newMed/comet_sd_pMpAcg_BC_itn_p3.5.tex}

Table \ref{comet_sd_pMpAcg_BC_itn_p3.5} shows the overhead caused by \parlotm, \parlota and \callgrind on each application of NPB benchmark. Last column of table shows the geometric mean of \textit{tracing overhead} by each tool for every application.
\\
On average, both \parlotm and \parlota has better performance than \callgrind. Bolded numbers in table \ref{comet_sd_pMpAcg_BC_itn_p3.5} for input C shows that the average overhead added by \parlotm is \textbf{1.98}, by \parlota is \textbf{2.83} and by \callgrind is \textbf{4.88} (all of the overhead has been calculated relative to native run as baseline). 
\\
Considering amount of collected traces by \parlot (especially \parlota) and \callgrind, clearly \parlot reaches the goal of "collecting more while adding less overhead"(fig. \ref{comet_chartAvg_sd_B_p3_5},\ref{comet_chartAvg_sd_C_p3_5}). By increasing the sizes of inputs, the average of geometric means of overheads decrease for \parlotm and \parlota but increase for \callgrind. 


\begin{figure}[!t]
\centering
\includegraphics[width=3.9in]{figs.comet.newMed/comet_chartAvg_sd_B_p3_5.png}
\caption{ Input: \textbf{B} - Slowdown of \parlotm ,\parlota and \callgrind. Each bar is the average slowdown of each tool on each application for 1, 4 and 16 and 64 nodes (16, 64, 256 and 1024 cores). 
}
\label{comet_chartAvg_sd_B_p3_5}
\end{figure}


\begin{figure}[!t]
\centering
\includegraphics[width=3.9in]{figs.comet.newMed/comet_chartAvg_sd_C_p3_5.png}
\caption{ Input: \textbf{C} - Slowdown of \parlotm ,\parlota and \callgrind. Each bar is the average slowdown of each tool on each application for 1, 4 and 16 and 64 nodes (16, 64, 256 and 1024 cores). . 
}
\label{comet_chartAvg_sd_C_p3_5}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Banwidth
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


  
\subsection{Required Bandwidth}
\label{subsec:lowbw}

\input{tabs.comet.newMed/comet_bw_pMpAcg_BC_itn_p3.5.tex}

Table \ref{comet_bw_pMpAcg_BC_itn_p3.5} shows how much bandwidth each tool occupied during the application execution. In addition to the large gap between average overhead of \parlotm and \callgrind, former also performs better than latter in required bandwidth, especially for smaller inputs. Since \parlota collects the trace of library function calls, there is no wonder why its required bandwidth is higher than other tools.

We observe from table \ref{comet_cr_pMpA_BC_itn_p3.5}, input C, the average compression ratio for \parlota is 644.38, and its corresponding required bandwidth from table \ref{comet_bw_pMpAcg_BC_itn_p3.5} is 56.38, which means \parlot can collect \textbf{more than 36 MB} worth of data per core per second where it only needs 56.38 kB/s bandwidth and leave the rest of available system bandwidth for application, while \callgrind can only collects \textbf{less than 100 kB} of traces and still adds more overhead comparing to either \parlota or \parlotm (fig. \ref{comet_chartAvg_bw_B_p3_5},\ref{comet_chartAvg_bw_C_p3_5}). The average amount of traces that can be collected by \parlota is \textbf{360x} (85x for \parlotm) larger than \callgrind and the average overhead \parlota adds is less than 0.6x (0.4x for \parlotm) smaller than \callgrind.

\begin{figure}[!t]
\centering
\includegraphics[width=3.5in]{figs.comet.newMed/comet_chartAvg_bw_B_p3_5.png}
\caption{ Input: \textbf{B} - Required Bandwidth per core (kB/s)
}
\label{comet_chartAvg_bw_B_p3_5}
\end{figure}



\begin{figure}[!t]
\centering
\includegraphics[width=3.5in]{figs.comet.newMed/comet_chartAvg_bw_C_p3_5.png}
\caption{ Input: \textbf{C}  - Required Bandwidth per core (kB/s)
}
\label{comet_chartAvg_bw_C_p3_5}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
\subsection{Compression Ratio}
\label{subsec:cr}

Table \ref{comet_cr_pMpA_BC_itn_p3.5} shows the compression ratios for all configurations and inputs. On average, \parlot can store up to more than 1700 MB of collected data in just 1 MB trace files. Compression mechanism of \parlot achieved more than 21k compression ratio (table \ref{comet_cr_pMpA_BC_itn_p3.5}, the entry for \parlotm, Input B, 1 node) and it has been achieved with adding low overhead and incrementally on the fly.
Generally, compression ratios for \parlotm are higher than \parlota. Since \parlota is collecting library function calls in addition to main image functions, chances of redundant data to compress decreases and causes drop in compression ratios.
  
\input{tabs.comet.newMed/comet_cr_pMpA_BC_itn_p3.5.tex}


\begin{figure}[!t]
\centering
\includegraphics[width=3.5in]{figs.comet.newMed/comet_chartAvg_cr_C_p3_5.png}
\caption{ Input: \textbf{C}  - Compression Ratio
}
\label{comet_chartAvg_cr_C_p3_5}
\end{figure}


\begin{figure}[!t]
\centering
\includegraphics[width=3.5in]{figs.comet.newMed/comet_chartAvg_cr_B_p3_5.png}
\caption{ Input: \textbf{B}  - Compression Ratio
}
\label{comet_chartAvg_cr_B_p3_5}
\end{figure}
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
  
\subsection{ \pininit Overhead} 
\label{subsec:pinit}
Tables \ref{comet_wo_det_Main_all_B_p3.5} and \ref{comet_wo_det_All_all_B_p3.5} show average overhead added to each application by different variations of \parlot. Last row of tables show geometric mean of each of its above values showing how much each phase of \parlot slows down the native execution. In general, we all expect that the added overhead of  \pininit < \parlot < \parlotnc. Highlighted cells in tables are the ones which do not follow the above order. The variability of 3 runs of each experiment is observable from boxes in figure \ref{comet_BX2_Main_16_B_p3_5} where it shows the minimum, maximum and median of overhead calculated overhead of each experiment for each tool, for input size B, 16 nodes.
This variability (which is similar for other inputs and nodes) justifies the inconsistent (highlighted) values in the table \ref{comet_wo_det_Main_all_B_p3.5} and \ref{comet_wo_det_All_all_B_p3.5}.


Tables \ref{comet_wo_det_Main_all_B_p3.5} and \ref{comet_wo_det_All_all_B_p3.5} shows that on average, \pininit adds 3.28 overhead and \parlota adds 3.42 overhead. \textbf{almost 96\% of \parlota overhead is added by \pininit} . Numbers from \parlotm and other inputs are following the same pattern (fig. \ref{comet_chartDet_B_wc_byTool_p3_5},\ref{comet_chartDet_C_wc_byTool_p3_5}).
The overhead that \parlot design (regardless of overhead of \pininit) adds to applications is extremely small and if we switch to a different instrumentation tool that is not as general as \pin but more lightweight, should help a great deal. \\

\input{tabs.comet.newMed/comet_wo_det_Main_all_B_p3.5.tex}

\input{tabs.comet.newMed/comet_wo_det_All_all_B_p3.5.tex}

\begin{figure}[!t]
\centering
\includegraphics[width=4in]{figs.comet.newMed/comet_chartDet_B_wc_byTool_p3_5.png}
\caption{ Input: \textbf{B} - \ref{comet_chartDet_C_wc_byTool_p3_5} 
}
\label{comet_chartDet_B_wc_byTool_p3_5}
\end{figure}


\begin{figure}[!t]
\centering
\includegraphics[width=4in]{figs.comet.newMed/comet_chartDet_C_wc_byTool_p3_5.png}
\caption{ Input: \textbf{C}
}
\label{comet_chartDet_C_wc_byTool_p3_5}
\end{figure}






\subsection{Compression impact} 
\label{subsec:compact}

Fig. \ref{comet_chartDet_B_woc_byTool_p3_5} and Fig. \ref{comet_chartDet_C_woc_byTool_p3_5} show the impact and necassity of compression. On average, \parlotnc slows down the application execution almost \textbf{2x} more than \parlota. Average overhead of geometric means of all overheads within table \ref{comet_wo_det_All_all_B_p3.5} for \parlota is \textbf{3.42} and for its corresponding \parlotnc is \textbf{6.62}. The numbers of \parlotm and input C is following the same pattern. For example, \parlot-nc slows down the application execution almost \textbf{1.66x} more than \parlotm.


\begin{figure}[!t]
\centering
\includegraphics[width=4in]{figs.comet.newMed/comet_chartDet_B_woc_byTool_p3_5.png}
\caption{ Input: \textbf{B}- This figure and figure \ref{comet_chartDet_C_woc_byTool_p3_5} shows the impact of \parlot 's data compression.
}
\label{comet_chartDet_B_woc_byTool_p3_5}
\end{figure}

\begin{figure}[!t]
\centering
\includegraphics[width=4in]{figs.comet.newMed/comet_chartDet_C_woc_byTool_p3_5.png}
\caption{ Input: \textbf{C}
}
\label{comet_chartDet_C_woc_byTool_p3_5}
\end{figure}




\begin{figure}[!t]
\centering
\includegraphics[width=4in]{figs.comet.newMed/comet_BX2_Main_16_B_p3_5.png}
\caption{ Variability of \parlotm overhead on 16 nodes (Input B)
}
\label{comet_BX2_Main_16_B_p3_5}
\end{figure}
